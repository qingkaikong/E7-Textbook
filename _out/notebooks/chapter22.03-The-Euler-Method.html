

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Euler Method &#8212; Python Numerical Methods</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Numerical Error and Instability" href="chapter22.04-Numerical-Error-and-Instability.html" />
    <link rel="prev" title="Reduction of Order" href="chapter22.02-Reduction-of-Order.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Python Numerical Methods</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter00.00-Preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter01.00-Python-Basics.html">
   Chapter 1 Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter02.00-Variables-and-Basic-Data-Structures.html">
   Chapter 2 Variables and Basic Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter03.00-Functions.html">
   Chapter 3 Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter04.00-Branching-Statements.html">
   Branching Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter05.00-Iteration.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter06.00-Recursion.html">
   Recursion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter07.00-Object-Oriented-Programming.html">
   Object Oriented Programming (OOP)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter08.00-Complexity.html">
   Complexity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter09.00-Representation-of-Numbers.html">
   Representation of Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter10.00-Errors-Practices-Debugging.html">
   Errors, Good Programming Practices, and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter11.00-Reading-and-Writing-Data.html">
   Reading and Writing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter12.00-Visualization-and-Plotting.html">
   Visualization and Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter13.00-Parallel-Your-Python.html">
   Parallel Your Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter14.00-Linear-Algebra-and-Systems-of-Linear-Equations.html">
   Linear Algebra and Systems of Linear Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter15.00-Eigenvalues-and-Eigenvectors.html">
   Eigenvalues and Eigenvectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter16.00-Least-Squares-Regression.html">
   Least Squares Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter17.00-Interpolation.html">
   Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter18.00-Series.html">
   Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter19.00-Root-Finding.html">
   Root Finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter20.00-Numerical-Differentiation.html">
   Numerical Differentiation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter21.00-Numerical-Integration.html">
   Numerical Integration
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="chapter22.00-ODE-Initial-Value-Problems.html">
   Ordinary Differential Equation - Initial Value Problems
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.01-ODE-Initial-Value-Problem-Statement.html">
     ODE Initial Value Problem Statement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.02-Reduction-of-Order.html">
     Reduction of Order
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     The Euler Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.04-Numerical-Error-and-Instability.html">
     Numerical Error and Instability
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.05-Predictor-Corrector-Methods.html">
     Predictor-Corrector and Runge Kutta Methods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.06-Python-ODE-Solvers.html">
     Python ODE Solvers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.07-Advanced-Topics.html">
     Advanced Topics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.08-Summary-and-Problems.html">
     Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter22.08-Summary-and-Problems.html#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter23.00-ODE-Boundary-Value-Problems.html">
   Ordinary Differential Equation - Boundary Value Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter24.00-Fourier-Transforms.html">
   Fourier Transform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter25.00-Introduction-to-Data-Driven-Approach.html">
   Introduction to Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix01-Getting-Started-with-Python-Windows.html">
   Getting Started with Python on Windows
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/chapter22.03-The-Euler-Method.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://pythonnumericalmethods.berkeley.edu"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!--BOOK_INFORMATION-->
<img align="left" style="padding-right:10px;" src="images/book_cover.jpg" width="120">
<p><em>This notebook contains an excerpt from the <a class="reference external" href="https://www.elsevier.com/books/python-programming-and-numerical-methods/kong/978-0-12-819549-9">Python Programming and Numerical Methods - A Guide for Engineers and Scientists</a>, the content is also available at <a class="reference external" href="https://pythonnumericalmethods.berkeley.edu/notebooks/Index.html">Berkeley Python Numerical Methods</a>.</em></p>
<p><em>The copyright of the book belongs to Elsevier. We also have this interactive book online for a better learning experience. The code is released under the <a class="reference external" href="https://opensource.org/licenses/MIT">MIT license</a>. If you find this content useful, please consider supporting the work on <a class="reference external" href="https://www.elsevier.com/books/python-programming-and-numerical-methods/kong/978-0-12-819549-9">Elsevier</a> or <a class="reference external" href="https://www.amazon.com/Python-Programming-Numerical-Methods-Scientists/dp/0128195495/ref=sr_1_1?dchild=1&amp;keywords=Python+Programming+and+Numerical+Methods+-+A+Guide+for+Engineers+and+Scientists&amp;qid=1604761352&amp;sr=8-1">Amazon</a>!</em></p>
<!--NAVIGATION-->
<p>&lt; <a class="reference internal" href="chapter22.02-Reduction-of-Order.html"><span class="doc std std-doc">22.2 Reduction of Order</span></a> | <a class="reference internal" href="Index.html"><span class="doc std std-doc">Contents</span></a> | <a class="reference internal" href="chapter22.04-Numerical-Error-and-Instability.html"><span class="doc std std-doc">22.4 Numerical Error and Instability</span></a> &gt;</p>
<div class="section" id="the-euler-method">
<h1>The Euler Method<a class="headerlink" href="#the-euler-method" title="Permalink to this headline">¶</a></h1>
<p>Let <span class="math notranslate nohighlight">\(\frac{dS(t)}{dt} = F(t,S(t))\)</span> be an explicitly defined first order ODE. That is, <span class="math notranslate nohighlight">\(F\)</span> is a function that returns the derivative, or change, of a state given a time and state value. Also, let <span class="math notranslate nohighlight">\(t\)</span> be a numerical grid of the interval <span class="math notranslate nohighlight">\([t_0, t_f]\)</span> with spacing <span class="math notranslate nohighlight">\(h\)</span>. Without loss of generality, we assume that <span class="math notranslate nohighlight">\(t_0 = 0\)</span>, and that <span class="math notranslate nohighlight">\(t_f = Nh\)</span> for some positive integer, <span class="math notranslate nohighlight">\(N\)</span>.</p>
<p>The linear approximation of <span class="math notranslate nohighlight">\(S(t)\)</span> around <span class="math notranslate nohighlight">\(t_j\)</span> at <span class="math notranslate nohighlight">\(t_{j+1}\)</span> is</p>
<div class="math notranslate nohighlight">
\[
S(t_{j+1}) = S(t_j) + (t_{j+1} - t_j)\frac{dS(t_j)}{dt},
\]</div>
<p>which can also be written</p>
<div class="math notranslate nohighlight">
\[
S(t_{j+1}) = S(t_j) + hF(t_j, S(t_j)).
\]</div>
<p>This formula is called the <strong>Explicit Euler Formula</strong>, and it allows us to compute an approximation for the state at <span class="math notranslate nohighlight">\(S(t_{j+1})\)</span> given the state at <span class="math notranslate nohighlight">\(S(t_j)\)</span>. Starting from a given initial value of <span class="math notranslate nohighlight">\(S_0 = S(t_0)\)</span>, we can use this formula to integrate the states up to <span class="math notranslate nohighlight">\(S(t_f)\)</span>; these <span class="math notranslate nohighlight">\(S(t)\)</span> values are then an approximation for the solution of the differential equation. The Explicit Euler formula is the simplest and most intuitive method for solving initial value problems. At any state <span class="math notranslate nohighlight">\((t_j, S(t_j))\)</span> it uses <span class="math notranslate nohighlight">\(F\)</span> at that state to “point” toward the next state and then moves in that direction a distance of <span class="math notranslate nohighlight">\(h\)</span>. Although there are more sophisticated and accurate methods for solving these problems, they all have the same fundamental structure. As such, we enumerate explicitly the steps for solving an initial value problem using the Explicit Euler formula.</p>
<img src="images/22.03.01-Euler-method-illustration.png" alt="explicit Euler" title="The illustration of the explicit Euler method." width="500"/><p><strong>WHAT IS HAPPENING?</strong> Assume we are given a function <span class="math notranslate nohighlight">\(F(t, S(t))\)</span> that computes <span class="math notranslate nohighlight">\(\frac{dS(t)}{dt}\)</span>, a numerical grid, <span class="math notranslate nohighlight">\(t\)</span>, of the interval, <span class="math notranslate nohighlight">\([t_0, t_f]\)</span>, and an initial state value <span class="math notranslate nohighlight">\(S_0 = S(t_0)\)</span>. We can compute <span class="math notranslate nohighlight">\(S(t_j)\)</span> for every <span class="math notranslate nohighlight">\(t_j\)</span> in <span class="math notranslate nohighlight">\(t\)</span> using the following steps.</p>
<ol class="simple">
<li><p>Store <span class="math notranslate nohighlight">\(S_0 = S(t_0)\)</span> in an array, <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(S(t_1) = S_0 + hF(t_0, S_0)\)</span>.</p></li>
<li><p>Store <span class="math notranslate nohighlight">\(S_1 = S(t_1)\)</span> in <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(S(t_2) = S_1 + hF(t_1, S_1)\)</span>.</p></li>
<li><p>Store <span class="math notranslate nohighlight">\(S_2 = S(t_1)\)</span> in <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\cdots\)</span></p></li>
<li><p>Compute <span class="math notranslate nohighlight">\(S(t_f) = S_{f-1} + hF(t_{f-1}, S_{f-1})\)</span>.</p></li>
<li><p>Store <span class="math notranslate nohighlight">\(S_f = S(t_f)\)</span> in <span class="math notranslate nohighlight">\(S\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(S\)</span> is an approximation of the solution to the initial value problem.</p></li>
</ol>
<p>When using a method with this structure, we say the method <strong>integrates</strong> the solution of the ODE.</p>
<p><strong>TRY IT!</strong> The differential equation <span class="math notranslate nohighlight">\(\frac{df(t)}{dt} = e^{-t}\)</span> with initial condition <span class="math notranslate nohighlight">\(f_0 = -1\)</span> has the exact solution <span class="math notranslate nohighlight">\(f(t) = -e^{-t}\)</span>. Approximate the solution to this initial value problem between 0 and 1 in increments of 0.1 using the Explicity Euler Formula. Plot the difference between the approximated solution and the exact solution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn-poster&#39;</span><span class="p">)</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>

<span class="c1"># Define parameters</span>
<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">)</span> <span class="c1"># ODE</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># Step size</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="c1"># Numerical grid</span>
<span class="n">s0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># Initial Condition</span>

<span class="c1"># Explicit Euler Method</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;bo--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Approximate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Approximate and Exact Solution </span><span class="se">\</span>
<span class="s1">for Simple ODE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter22.03-The-Euler-Method_6_0.png" src="../_images/chapter22.03-The-Euler-Method_6_0.png" />
</div>
</div>
<p>In the above figure, we can see each dot is one approximation based on the previous dot in a linear fashion. From the initial value, we can eventually get an approximation of the solution on the numerical grid. If we repeat the process for <span class="math notranslate nohighlight">\(h = 0.01\)</span>, we get a better approximation for the solution:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">h</span> <span class="o">=</span> <span class="mf">0.01</span> <span class="c1"># Step size</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span> <span class="c1"># Numerical grid</span>
<span class="n">s0</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># Initial Condition</span>

<span class="c1"># Explicit Euler Method</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">s0</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">s</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">f</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="s1">&#39;b--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Approximate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span><span class="p">),</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Exact&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Approximate and Exact Solution </span><span class="se">\</span>
<span class="s1">for Simple ODE&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;f(t)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/chapter22.03-The-Euler-Method_8_0.png" src="../_images/chapter22.03-The-Euler-Method_8_0.png" />
</div>
</div>
<p>The Explicit Euler Formula is called “explicit” because it only requires information at <span class="math notranslate nohighlight">\(t_j\)</span> to compute the state at <span class="math notranslate nohighlight">\(t_{j+1}\)</span>. That is, <span class="math notranslate nohighlight">\(S(t_{j+1})\)</span> can be written explicitly in terms of values we have (i.e., <span class="math notranslate nohighlight">\(t_j\)</span> and <span class="math notranslate nohighlight">\(S(t_j)\)</span>). The <strong>Implicit Euler Formula</strong> can be derived by taking the linear approximation of <span class="math notranslate nohighlight">\(S(t)\)</span> around <span class="math notranslate nohighlight">\(t_{j+1}\)</span> and computing it at <span class="math notranslate nohighlight">\(t_j\)</span>:</p>
<div class="math notranslate nohighlight">
\[
S(t_{j+1}) = S(t_j) + hF(t_{j+1}, S(t_{j+1})).
\]</div>
<p>This formula is peculiar because it requires that we know <span class="math notranslate nohighlight">\(S(t_{j+1})\)</span> to compute <span class="math notranslate nohighlight">\(S(t_{j+1})\)</span>! However, it happens that sometimes we <em>can</em> use this formula to approximate the solution to initial value problems. Before we give details on how to solve these problems using the Implicit Euler Formula, we give another implicit formula called the <strong>Trapezoidal Formula</strong>, which is the average of the Explicit and Implicit Euler Formulas:</p>
<div class="math notranslate nohighlight">
\[
S(t_{j+1}) = S(t_j) + \frac{h}{2}(F(t_j, S(t_j)) + F(t_{j+1}, S(t_{j+1}))).
\]</div>
<p>To illustrate how to solve these implicit schemes, consider again the pendulum equation, which has been reduced to first order.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{dS(t)}{dt} =\left[\begin{array}{cc}
0 &amp; 1 \\
-\frac{g}{l} &amp; 0
\end{array}\right]S(t)
\end{split}\]</div>
<p>For this equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
F(t_j, S(t_j)) =\left[\begin{array}{cc}
0 &amp; 1 \\
-\frac{g}{l} &amp; 0
\end{array}\right]S(t_j).
\end{split}\]</div>
<p>If we plug this expression into the Explicit Euler Formula, we get the following equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
S(t_{j+1}) = S(t_j) + h \left[\begin{array}{cc}
0 &amp; 1 \\
-\frac{g}{l} &amp; 0
\end{array}\right]S(t_j) = \left[\begin{array}{cc}
1 &amp; 0 \\
0 &amp; 1
\end{array}\right]S(t_j) + h\left[\begin{array}{cc}
0 &amp; 1 \\
-\frac{g}{l} &amp; 0
\end{array}\right]S(t_j)= \left[\begin{array}{cc}
1 &amp; h \\
-\frac{gh}{l} &amp; 1
\end{array}\right]S(t_j)
\end{split}\]</div>
<p>Similarly, we can plug the same expression into the Implicit Euler to get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[\begin{array}{cc}
1 &amp; -h \\
\frac{gh}{l} &amp; 1
\end{array}\right]S(t_{j+1}) = S(t_j),
\end{split}\]</div>
<p>and into the Trapezoidal Formula to get</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\left[\begin{array}{cc}
1 &amp; -\frac{h}{2} \\
\frac{gh}{2l} &amp; 1
\end{array}\right]S(t_{j+1}) = \left[\begin{array}{cc}
1 &amp; \frac{h}{2} \\
-\frac{gh}{2l} &amp; 1
\end{array}\right]S(t_j).
\end{split}\]</div>
<p>With some rearrangement, these equations become, respectively,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
&amp;&amp; S(t_{j+1}) = \left[\begin{array}{cc}
1 &amp; -h \\
\frac{gh}{l} &amp; 1
\end{array}\right]^{-1} S(t_j),\\
&amp;&amp; S(t_{j+1}) = \left[\begin{array}{cc}
1 &amp; -\frac{h}{2} \\
\frac{gh}{2l} &amp; 1
\end{array}\right]^{-1}\left[\begin{array}{cc}
1 &amp; \frac{h}{2} \\
-\frac{gh}{2l} &amp; 1
\end{array}\right]S(t_j).
\end{eqnarray*}
\end{split}\]</div>
<p>These equations allow us to solve the initial value problem, since at each state, <span class="math notranslate nohighlight">\(S(t_j)\)</span>, we can compute the next state at <span class="math notranslate nohighlight">\(S(t_{j+1})\)</span>. In general, this is possible to do when an ODE is linear.</p>
<!--NAVIGATION-->
<p>&lt; <a class="reference internal" href="chapter22.02-Reduction-of-Order.html"><span class="doc std std-doc">22.2 Reduction of Order</span></a> | <a class="reference internal" href="Index.html"><span class="doc std std-doc">Contents</span></a> | <a class="reference internal" href="chapter22.04-Numerical-Error-and-Instability.html"><span class="doc std std-doc">22.4 Numerical Error and Instability</span></a> &gt;</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chapter22.02-Reduction-of-Order.html" title="previous page">Reduction of Order</a>
    <a class='right-next' id="next-link" href="chapter22.04-Numerical-Error-and-Instability.html" title="next page">Numerical Error and Instability</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>