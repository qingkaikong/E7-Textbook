

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summary &#8212; Python Numerical Methods</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/mystnb.js"></script>
    <script src="../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Ordinary Differential Equation - Initial Value Problems" href="chapter22.00-ODE-Initial-Value-Problems.html" />
    <link rel="prev" title="Computing Integrals in Python" href="chapter21.05-Computing-Integrals-in-Python.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  
  <h1 class="site-logo" id="site-title">Python Numerical Methods</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter00.00-Preface.html">
   Preface
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter01.00-Python-Basics.html">
   Chapter 1 Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter02.00-Variables-and-Basic-Data-Structures.html">
   Chapter 2 Variables and Basic Data Structures
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter03.00-Functions.html">
   Chapter 3 Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter04.00-Branching-Statements.html">
   Branching Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter05.00-Iteration.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter06.00-Recursion.html">
   Recursion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter07.00-Object-Oriented-Programming.html">
   Object Oriented Programming (OOP)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter08.00-Complexity.html">
   Complexity
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter09.00-Representation-of-Numbers.html">
   Representation of Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter10.00-Errors-Practices-Debugging.html">
   Errors, Good Programming Practices, and Debugging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter11.00-Reading-and-Writing-Data.html">
   Reading and Writing Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter12.00-Visualization-and-Plotting.html">
   Visualization and Plotting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter13.00-Parallel-Your-Python.html">
   Parallel Your Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter14.00-Linear-Algebra-and-Systems-of-Linear-Equations.html">
   Linear Algebra and Systems of Linear Equations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter15.00-Eigenvalues-and-Eigenvectors.html">
   Eigenvalues and Eigenvectors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter16.00-Least-Squares-Regression.html">
   Least Squares Regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter17.00-Interpolation.html">
   Interpolation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter18.00-Series.html">
   Series
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter19.00-Root-Finding.html">
   Root Finding
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter20.00-Numerical-Differentiation.html">
   Numerical Differentiation
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="reference internal" href="chapter21.00-Numerical-Integration.html">
   Numerical Integration
  </a>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="chapter21.01-Numerical-Integration-Problem-Statement.html">
     Numerical Integration Problem Statement
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter21.02-Riemanns-Integral.html">
     Riemanns Integral
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter21.03-Trapezoid-Rule.html">
     Trapezoid Rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter21.04-Simpsons-Rule.html">
     Simpsonâ€™s Rule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="chapter21.05-Computing-Integrals-in-Python.html">
     Computing Integrals in Python
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Summary
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="#problems">
     Problems
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter22.00-ODE-Initial-Value-Problems.html">
   Ordinary Differential Equation - Initial Value Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter23.00-ODE-Boundary-Value-Problems.html">
   Ordinary Differential Equation - Boundary Value Problems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter24.00-Fourier-Transforms.html">
   Fourier Transform
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter25.00-Introduction-to-Data-Driven-Approach.html">
   Introduction to Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Appendix01-Getting-Started-with-Python-Windows.html">
   Getting Started with Python on Windows
  </a>
 </li>
</ul>

</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/notebooks/chapter21.06-Summary-and-Problems.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://pythonnumericalmethods.berkeley.edu"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> On this page
        </div>
        <nav id="bd-toc-nav">
            
        </nav>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!--BOOK_INFORMATION-->
<img align="left" style="padding-right:10px;" src="images/book_cover.jpg" width="120">
<p><em>This notebook contains an excerpt from the <a class="reference external" href="https://www.elsevier.com/books/python-programming-and-numerical-methods/kong/978-0-12-819549-9">Python Programming and Numerical Methods - A Guide for Engineers and Scientists</a>, the content is also available at <a class="reference external" href="https://pythonnumericalmethods.berkeley.edu/notebooks/Index.html">Berkeley Python Numerical Methods</a>.</em></p>
<p><em>The copyright of the book belongs to Elsevier. We also have this interactive book online for a better learning experience. The code is released under the <a class="reference external" href="https://opensource.org/licenses/MIT">MIT license</a>. If you find this content useful, please consider supporting the work on <a class="reference external" href="https://www.elsevier.com/books/python-programming-and-numerical-methods/kong/978-0-12-819549-9">Elsevier</a> or <a class="reference external" href="https://www.amazon.com/Python-Programming-Numerical-Methods-Scientists/dp/0128195495/ref=sr_1_1?dchild=1&amp;keywords=Python+Programming+and+Numerical+Methods+-+A+Guide+for+Engineers+and+Scientists&amp;qid=1604761352&amp;sr=8-1">Amazon</a>!</em></p>
<!--NAVIGATION-->
<p>&lt; <a class="reference internal" href="chapter21.05-Computing-Integrals-in-Python.html"><span class="doc std std-doc">21.5 Computing Integrals in Python</span></a> | <a class="reference internal" href="Index.html"><span class="doc std std-doc">Contents</span></a> | <a class="reference internal" href="chapter22.00-ODE-Initial-Value-Problems.html"><span class="doc std std-doc">CHAPTER 22. Ordinary Differential Equations (ODEs): Initial-Value Problems</span></a> &gt;</p>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">Â¶</a></h1>
<ol class="simple">
<li><p>Explicit integration of functions is often impossible or inconvenient, and numerical approaches must be used instead.</p></li>
<li><p>The Riemann Integral, Trapezoid Rule, and Simpsonâ€™s Rule are common methods of approximating integrals.</p></li>
<li><p>Each method has an order of accuracy that depends on the approximation of the area below the function.</p></li>
</ol>
</div>
<div class="section" id="problems">
<h1>Problems<a class="headerlink" href="#problems" title="Permalink to this headline">Â¶</a></h1>
<ol class="simple">
<li><p>Write a function <span class="math notranslate nohighlight">\(my\_int\_calc(f, f0, a, b, N, option)\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is a function object, <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> are scalars such that a &lt; b, <span class="math notranslate nohighlight">\(N\)</span> is a positive integer, and <span class="math notranslate nohighlight">\(option\)</span> is the string â€˜rectâ€™, â€˜trapâ€™, or â€˜simpâ€™. Let <span class="math notranslate nohighlight">\(x\)</span> be an array starting at <span class="math notranslate nohighlight">\(a\)</span>, ending at <span class="math notranslate nohighlight">\(b\)</span>, containing <span class="math notranslate nohighlight">\(N\)</span> evenly spaced elements. The output argument, <span class="math notranslate nohighlight">\(I\)</span>, should be an approximation to the integral of <span class="math notranslate nohighlight">\(f(x)\)</span>, with initial condition <span class="math notranslate nohighlight">\(f0\)</span>, computed according to the input argument, <span class="math notranslate nohighlight">\(option\)</span>.</p></li>
<li><p>Write a function <span class="math notranslate nohighlight">\(my\_poly\_int(x, y)\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> are one-dimensional arrays of the same size, and the elements of <span class="math notranslate nohighlight">\(x\)</span> are unique and in ascending order. The function <span class="math notranslate nohighlight">\(my\_poly\_int\)</span> should (1) compute the Lagrange polynomial going through all the points defined by <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> and (2) return an approximation to the area under the curve defined by <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, <span class="math notranslate nohighlight">\(I\)</span>, defined as the analytic integral of the Lagrange interpolating polynomial.</p></li>
<li><p>When will <span class="math notranslate nohighlight">\(my\_poly\_int\)</span> work <em>worse</em> than the trapezoid method?</p></li>
<li><p>Write a function <span class="math notranslate nohighlight">\(my\_num\_calc(f, a, b, n, option)\)</span>, where the output <span class="math notranslate nohighlight">\(I\)</span> is the numerical integral of <span class="math notranslate nohighlight">\(f\)</span>, a function object, computed on a grid of <span class="math notranslate nohighlight">\(n\)</span> evenly spaced points starting at <span class="math notranslate nohighlight">\(a\)</span> and ending at <span class="math notranslate nohighlight">\(b\)</span>. The integration method used should be one of the following strings defined by option: â€˜rectâ€™, â€˜trapâ€™, â€˜simpâ€™. For the rectangle method, the function value should be taken from the right endpoint of the interval. You may assume that <span class="math notranslate nohighlight">\(n\)</span> is odd.</p></li>
</ol>
<p>Warning: In the reader, the <span class="math notranslate nohighlight">\(x\)</span> subscripts start at <span class="math notranslate nohighlight">\(x_0\)</span> not <span class="math notranslate nohighlight">\(x_1\)</span>; take note of this when programming your loops. The odd-even indices will be reversed. Also the <span class="math notranslate nohighlight">\(n\)</span> term given in Simpsons Rule denotes the number of subintervals, not the number of points as specified by the input argument, <span class="math notranslate nohighlight">\(n\)</span>.</p>
<p>Test Cases:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">In</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">my_num_int</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;rect&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> <span class="mf">0.625</span>
   
<span class="n">In</span><span class="p">:</span> <span class="n">my_num_int</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;trap&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> <span class="mf">0.375</span>
   
<span class="n">In</span><span class="p">:</span> <span class="n">my_num_int</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;simp&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> <span class="mf">0.3333333333333333</span>
   
<span class="n">In</span><span class="p">:</span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">my_num_int</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="s1">&#39;simp&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> <span class="mf">2.9253035883926493</span>
   
<span class="n">In</span><span class="p">:</span> <span class="n">my_num_int</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10001</span><span class="p">,</span> <span class="s1">&#39;simp&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> <span class="mf">2.925303491814364</span>
   
<span class="n">In</span><span class="p">:</span> <span class="n">my_num_int</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100001</span><span class="p">,</span> <span class="s1">&#39;simp&#39;</span><span class="p">)</span>
<span class="n">Out</span><span class="p">:</span> <span class="mf">2.9253034918143634</span>
</pre></div>
</div>
<ol class="simple">
<li><p>A previous chapter demonstrated that some functions can be expressed as an infinite sum of polynomials (i.e. Taylor series). Other functions, particularly periodic functions, can be written as an infinite sum of sine and cosine waves. For these functions,</p></li>
</ol>
<div class="math notranslate nohighlight">
\[f(x)= \frac{A_0}{2}+\sum_{n=1}^{\infty}A_n\ \cos{(nx)} + B_n\ \sin{(nx)}\]</div>
<p>It can be shown that the values of <span class="math notranslate nohighlight">\(A_n\)</span> and <span class="math notranslate nohighlight">\(B_n\)</span> can be computed using the following formulas:</p>
<div class="math notranslate nohighlight">
\[A_n= \frac{1}{\pi} \int_{-\pi}^{\pi} f(x) \cos{(nx)}\ dx\]</div>
<div class="math notranslate nohighlight">
\[B_n= \frac{1}{\pi} \int_{-\pi}^{\pi} f(x) \sin{(nx)}\ dx\]</div>
<p>Just like Taylor series, functions can be approximated by truncating the Fourier series at some <span class="math notranslate nohighlight">\(n = N\)</span>. Fourier series can be used to approximate some particularly nasty functions such as the step function, and they form the basis of many engineering applications such as signal processing.</p>
<p>Write a function <span class="math notranslate nohighlight">\(my\_fourier\_coef(f, n)\)</span>, with output <span class="math notranslate nohighlight">\([A_n, B_n]\)</span>, where <span class="math notranslate nohighlight">\(f\)</span> is an function object that is <span class="math notranslate nohighlight">\(2\pi\)</span>-periodic. The function <span class="math notranslate nohighlight">\(my\_fourier\_coef\)</span> should compute the <span class="math notranslate nohighlight">\(n\)</span>-th Fourier coefficients, <span class="math notranslate nohighlight">\(A_n\)</span> and <span class="math notranslate nohighlight">\(B_n\)</span>, in the Fourier series for <span class="math notranslate nohighlight">\(f\)</span> defined by the two formulas given earlier. You should use the <span class="math notranslate nohighlight">\(quad\)</span> function to perform the integration.</p>
<p>Test Cases:</p>
<p>Use the following plotting function to plot the analytic and approximation of functions using the fourier series.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="k">def</span> <span class="nf">plot_results</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="p">[</span><span class="n">A0</span><span class="p">,</span> <span class="n">B0</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_fourier_coef</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">A0</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">):</span>
        <span class="p">[</span><span class="n">An</span><span class="p">,</span> <span class="n">Bn</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_fourier_coef</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">+=</span> <span class="n">An</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">+</span><span class="n">Bn</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;analytic&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;approximate&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">N</span><span class="si">}</span><span class="s1">th Order Fourier Approximation&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
   
 <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
 <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
 <span class="n">plot_results</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../_images/21.06.01-Solution_for_Question_4.jpg" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
 <span class="n">plot_results</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../_images/21.06.02-Solution_for_Question_4.jpg" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mod</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">N</span> <span class="o">=</span> <span class="mi">5</span>
 <span class="n">plot_results</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../_images/21.06.03-Solution_for_Question_4.jpg" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
 <span class="n">plot_results</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../_images/21.06.04-Solution_for_Question_4.jpg" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
 <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>
 <span class="n">plot_results</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../_images/21.06.05-Solution_for_Question_4.jpg" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
 <span class="n">plot_results</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="../_images/21.06.06-Solution_for_Question_4.jpg" /></p>
<ol class="simple">
<li><p>For a numerical grid with spacing <span class="math notranslate nohighlight">\(h\)</span>, Booleâ€™s Rule for approximating integrals says that</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\int_{x_i}^{x_{i+4}} f(x) dx \approx \frac{3h}{90} \left[7f(x_i)+32f(x_{i+1})+12f(x_{i+2})+32f(x_{i+3})+7f(x_{i+4})\right].\]</div>
<p>Show that Booleâ€™s Rule is <span class="math notranslate nohighlight">\(O(h^7)\)</span> over a single subinterval.</p>
<!--NAVIGATION-->
<p>&lt; <a class="reference internal" href="chapter21.05-Computing-Integrals-in-Python.html"><span class="doc std std-doc">21.5 Computing Integrals in Python</span></a> | <a class="reference internal" href="Index.html"><span class="doc std std-doc">Contents</span></a> | <a class="reference internal" href="chapter22.00-ODE-Initial-Value-Problems.html"><span class="doc std std-doc">CHAPTER 22. Ordinary Differential Equations (ODEs): Initial-Value Problems</span></a> &gt;</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="chapter21.05-Computing-Integrals-in-Python.html" title="previous page">Computing Integrals in Python</a>
    <a class='right-next' id="next-link" href="chapter22.00-ODE-Initial-Value-Problems.html" title="next page">Ordinary Differential Equation - Initial Value Problems</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../_static/js/index.js"></script>
    
  </body>
</html>